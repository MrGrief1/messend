<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Вход / Регистрация - GlassChat</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body data-theme="dark" class="auth-page">
    <div class="auth-orbit">
        <span class="orbit orbit-primary"></span>
        <span class="orbit orbit-secondary"></span>
        <span class="orbit orbit-tertiary"></span>
    </div>

    <div class="auth-wrapper">
        <aside class="auth-showcase glass">
            <div class="showcase-header">
                <span class="badge badge-primary">GlassChat 2.1</span>
                <h1>Единая платформа для звонков, групп и чатов</h1>
                <p>Вдохновлённый строгим стилем Element, Messend теперь сочетает стеклянные поверхности и аккуратную типографику
                    с новым вниманием к приватности и стабильности.</p>
            </div>

            <ul class="showcase-features">
                <li class="feature-item">
                    <div class="feature-icon" aria-hidden="true">
                        <svg viewBox="0 0 24 24" role="presentation"><path d="M4 6.5A2.5 2.5 0 0 1 6.5 4h11A2.5 2.5 0 0 1 20 6.5v11a2.5 2.5 0 0 1-2.5 2.5h-11A2.5 2.5 0 0 1 4 17.5v-11Z" fill="none" stroke="currentColor" stroke-width="1.5"/><path d="M9.5 9h5M9.5 12h5M9.5 15H14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="m6 8 3-3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
                    </div>
                    <div class="feature-text">
                        <h3>Гладкий интерфейс</h3>
                        <p>Переработанные панели, чистые тени и стекло-эффект делают работу в Messend спокойной и предсказуемой.</p>
                    </div>
                </li>
                <li class="feature-item">
                    <div class="feature-icon" aria-hidden="true">
                        <svg viewBox="0 0 24 24" role="presentation"><path d="M5 7a4 4 0 0 1 4-4h6a4 4 0 0 1 4 4v10a4 4 0 0 1-4 4H9a4 4 0 0 1-4-4V7Z" fill="none" stroke="currentColor" stroke-width="1.5"/><path d="M8.5 9H12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M8.5 12h7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M8.5 15h5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
                    </div>
                    <div class="feature-text">
                        <h3>Совместные комнаты</h3>
                        <p>Группы, треды и голосовые пространства объединены в одном окне с быстрым поиском и статусами участников.</p>
                    </div>
                </li>
                <li class="feature-item">
                    <div class="feature-icon" aria-hidden="true">
                        <svg viewBox="0 0 24 24" role="presentation"><path d="M5.5 8.5a6.5 6.5 0 0 1 13 0v3a6.5 6.5 0 0 1-13 0v-3Z" fill="none" stroke="currentColor" stroke-width="1.5"/><path d="M9 17a3 3 0 0 0 6 0" stroke="currentColor" stroke-width="1.5"/><path d="M15.5 20.5H8.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
                    </div>
                    <div class="feature-text">
                        <h3>Звонки без задержек</h3>
                        <p>Синхронные звонки, совместный экран и умное шумоподавление доступны в пару кликов.</p>
                    </div>
                </li>
            </ul>

            <div class="showcase-footer">
                <div class="security-callout">
                    <h4>Сохраняем приватность</h4>
                    <p>Обновленная авторизация использует QR-доступ и вход по email, а восстановление пароля стало безопаснее.</p>
                </div>
                <div class="avatars-stack" aria-hidden="true">
                    <span class="avatar avatar-blue"></span>
                    <span class="avatar avatar-lilac"></span>
                    <span class="avatar avatar-orange"></span>
                    <span class="avatar avatar-green"></span>
                </div>
            </div>
        </aside>

        <main class="auth-content">
            <section class="auth-card glass">
                <header class="auth-card__header">
                    <div class="auth-tabs" role="tablist">
                        <button class="auth-tab is-active" data-target="login-form" type="button">Войти</button>
                        <button class="auth-tab" data-target="register-form" type="button">Создать аккаунт</button>
                    </div>
                    <p class="auth-subtitle" id="auth-subtitle">Добро пожаловать обратно! Введите свой логин или email.</p>
                </header>

                <div class="auth-card__body">
                    <form id="login-form" class="auth-form auth-form--active" novalidate>
                        <label class="input-group">
                            <span class="input-label">Имя пользователя или Email</span>
                            <input type="text" id="login-identifier" placeholder="@username или email" autocomplete="username" required>
                        </label>
                        <label class="input-group input-with-action">
                            <span class="input-label">Пароль</span>
                            <input type="password" id="login-password" placeholder="Введите пароль" autocomplete="current-password" required>
                            <button type="button" class="input-action" data-toggle="password" data-target="login-password">Показать</button>
                        </label>
                        <div class="form-actions">
                            <button type="button" class="btn-primary" onclick="handleLogin()">Войти</button>
                            <button type="button" class="btn-link" data-action="forgot">Забыли пароль?</button>
                        </div>
                    </form>

                    <form id="register-form" class="auth-form" novalidate>
                        <label class="input-group">
                            <span class="input-label">Отображаемое имя</span>
                            <input type="text" id="register-display-name" placeholder="Как вас представить" autocomplete="name">
                        </label>
                        <label class="input-group">
                            <span class="input-label">@Тег пользователя</span>
                            <div class="input-prefix">
                                <span class="prefix">@</span>
                                <input type="text" id="register-username" placeholder="username" autocomplete="username" required>
                            </div>
                        </label>
                        <label class="input-group">
                            <span class="input-label">Email для восстановления</span>
                            <input type="email" id="register-email" placeholder="name@example.com" autocomplete="email" required>
                        </label>
                        <label class="input-group input-with-action">
                            <span class="input-label">Пароль</span>
                            <input type="password" id="register-password" placeholder="Минимум 8 символов" autocomplete="new-password" required>
                            <button type="button" class="input-action" data-toggle="password" data-target="register-password">Показать</button>
                        </label>
                        <div class="password-meter" id="register-password-meter" aria-hidden="true">
                            <span class="password-meter__bar"></span>
                            <span class="password-meter__label">Слабый пароль</span>
                        </div>
                        <label class="checkbox-group">
                            <input type="checkbox" id="privacy-optin" checked>
                            <span>Получать push-уведомления о входе с новых устройств</span>
                        </label>
                        <button type="button" class="btn-primary" onclick="handleRegister()">Создать аккаунт</button>
                        <p class="form-meta">Уже зарегистрированы? <button type="button" class="btn-inline" data-switch="login-form">Войти</button></p>
                    </form>
                </div>

                <div class="message-box" id="message-box" role="alert" aria-live="polite">
                    <span class="message-box__icon" aria-hidden="true"></span>
                    <span class="message-box__text"></span>
                </div>

                <footer class="auth-card__footer">
                    <div class="auth-footnote">
                        <p>Присоединяйтесь к сообществам Messend, синхронизируйте устройство и управляйте безопасностью из единой панели.
                        </p>
                        <div class="auth-mini-grid">
                            <div class="mini-card">
                                <h4>Звонки и экраны</h4>
                                <p>Совместные созвоны с видеосеткой и шарингом экрана на всех устройствах.</p>
                            </div>
                            <div class="mini-card">
                                <h4>Управление группами</h4>
                                <p>Роли участников, обложки комнат, быстрые реакции и треды обсуждений.</p>
                            </div>
                        </div>
                    </div>
                </footer>
            </section>
        </main>
    </div>

    <div class="forgot-password-modal" id="forgot-password-modal" role="dialog" aria-modal="true" aria-labelledby="forgot-title">
        <div class="modal-content glass">
            <header class="modal-header">
                <h2 id="forgot-title">Восстановление доступа</h2>
                <button class="modal-close" type="button" data-action="close-forgot" aria-label="Закрыть окно"></button>
            </header>
            <p class="modal-description">Введите email, который вы указывали при регистрации. Мы отправим одноразовую ссылку для
                сброса пароля.</p>
            <label class="input-group">
                <span class="input-label">Email</span>
                <input type="email" id="forgot-email" placeholder="name@example.com" autocomplete="email" required>
            </label>
            <div class="modal-actions">
                <button type="button" class="btn-primary" onclick="handleForgotPassword()">Отправить ссылку</button>
                <button type="button" class="btn-ghost" data-action="close-forgot">Отмена</button>
            </div>
            <div id="forgot-message" class="modal-message"></div>
            <p class="modal-hint">💡 Письмо может прийти с задержкой 3–5 минут. Не забудьте проверить папку «Спам».</p>
        </div>
    </div>

    <script>
        try {
            const t = localStorage.getItem('appTheme');
            if (t) document.body.setAttribute('data-theme', t);
        } catch (error) {
            console.warn('Не удалось восстановить тему интерфейса', error);
        }
    </script>
    <script src="{{ url_for('static', filename='js/auth.js') }}"></script>
</body>
</html>
