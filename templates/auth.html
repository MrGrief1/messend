<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GlassChat — вход и регистрация</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body class="auth-body" data-theme="dark">
    <div class="auth-container">
        <div class="auth-backdrop">
            <span class="auth-orb"></span>
            <span class="auth-orb"></span>
            <span class="auth-orb"></span>
        </div>
        <div class="auth-shell">
            <section class="auth-hero glass">
                <div>
                    <h1>Сообщения, звонки и команды в едином пространстве</h1>
                    <p>
                        Современный клиент Messend сочетает в себе визуальную эстетику стекла и функциональность Element: быстрые переписки, зашифрованные звонки и гибкие группы.
                    </p>
                </div>
                <ul>
                    <li>Новые вызовы и встречи в один клик</li>
                    <li>Впечатляющая тёмная тема с эффектом стекла</li>
                    <li>Интеллектуальные уведомления и общий поиск</li>
                </ul>
                <div class="auth-footnote">
                    <strong>Совет:</strong> подтвердите почту, чтобы получить доступ ко всем функциям, включая групповые звонки и совместную работу в каналах.
                </div>
            </section>
            <section class="auth-card">
                <div class="auth-brand">
                    <div class="auth-logo">M</div>
                    <div>
                        <h1>GlassChat</h1>
                        <p class="lead">Переосмысленная авторизация с плавными переходами</p>
                    </div>
                </div>
                <div class="auth-tabs" role="tablist">
                    <button type="button" class="auth-tab active" data-target="login" role="tab" aria-selected="true" onclick="toggleForms('login')">Вход</button>
                    <button type="button" class="auth-tab" data-target="register" role="tab" aria-selected="false" onclick="toggleForms('register')">Регистрация</button>
                </div>
                <div id="message-box" class="message-box" hidden></div>
                <div class="auth-forms" data-active="login">
                    <div id="login-form" class="auth-form is-active" role="tabpanel">
                        <div class="input-group">
                            <label for="login-identifier">Имя пользователя или email</label>
                            <input type="text" id="login-identifier" placeholder="@username или email" autocomplete="username" required>
                        </div>
                        <div class="input-group">
                            <label for="login-password">Пароль</label>
                            <input type="password" id="login-password" placeholder="Введите пароль" autocomplete="current-password" required>
                        </div>
                        <button type="button" onclick="handleLogin()">Войти</button>
                        <div class="auth-cta">
                            <span>Ещё нет аккаунта?</span>
                            <a onclick="toggleForms('register')">Создать</a>
                        </div>
                        <div class="toggle-link">
                            <a onclick="showForgotPassword()">Забыли пароль?</a>
                        </div>
                    </div>
                    <div id="register-form" class="auth-form" role="tabpanel" aria-hidden="true">
                        <div class="input-group">
                            <label for="register-username">Имя пользователя</label>
                            <input type="text" id="register-username" placeholder="Например, glassmaster" autocomplete="nickname" required>
                        </div>
                        <div class="input-group">
                            <label for="register-email">Email для подтверждения</label>
                            <input type="email" id="register-email" placeholder="name@example.com" autocomplete="email" required>
                        </div>
                        <div class="input-group">
                            <label for="register-password">Пароль</label>
                            <input type="password" id="register-password" placeholder="Минимум 8 символов" autocomplete="new-password" required>
                        </div>
                        <button type="button" onclick="handleRegister()">Зарегистрироваться</button>
                        <div class="auth-divider">или</div>
                        <div class="toggle-link">
                            Уже зарегистрированы? <a onclick="toggleForms('login')">Войти</a>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <div id="forgot-password-modal" class="modal-overlay" style="display: none;" onclick="closeForgotPassword()">
        <div class="glass modal-content" onclick="event.stopPropagation()">
            <button type="button" class="icon-btn close-modal" onclick="closeForgotPassword()" aria-label="Закрыть">&times;</button>
            <h2>Восстановление пароля</h2>
            <p>Укажите email, чтобы получить ссылку для сброса.</p>
            <div class="input-group">
                <label for="forgot-email">Email</label>
                <input type="email" id="forgot-email" placeholder="name@example.com" required>
            </div>
            <div id="forgot-message" class="message-box" hidden></div>
            <div class="modal-actions">
                <button type="button" onclick="handleForgotPassword()">Отправить</button>
                <button type="button" class="secondary" onclick="closeForgotPassword()">Отмена</button>
            </div>
            <p class="modal-hint">Письмо может прийти в течение нескольких минут. Проверьте папку «Спам».</p>
        </div>
    </div>

    <script>
        try {
            const savedTheme = localStorage.getItem('appTheme');
            if (savedTheme) {
                document.body.setAttribute('data-theme', savedTheme);
            }
        } catch (e) {}
    </script>
    <script src="{{ url_for('static', filename='js/auth.js') }}"></script>
</body>
</html>
